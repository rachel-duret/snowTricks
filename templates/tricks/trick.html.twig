{% extends 'base.html.twig' %}

{% block title %}Hello Trick!
{% endblock %}

{% block body %}
	<div class="container">
		<div class="row ">
			<div class="col-12 col-sm-6">
				<div class="mx-auto row d-flex flex-md-row justify-content-md-between justify-content-center">

					<div class="card  mt-4 mb-4 p-0">
						<div id="carouselImageControls" class="carousel slide" data-bs-ride="carousel">
							<div class="carousel-inner">
								{% for image in trick.images %}
									<div class="carousel-item active">
										{% if app.user and app.user is same as trick.user %}
											<a href="{{path('app_delete_image', {id: image.id})}}" class="btn btn-danger position-absolute  top-0 end-0" style="z-index: 9999;">
												<i class="bi bi-x-circle-fill"></i>
											</a>
											<img src="{{image.imagePath}}" class="d-block w-100 rounded " alt="{{ trick.title }}">
										{% endif %}
									</div>
								{% endfor %}

							</div>
							<button class="carousel-control-prev" type="button" data-bs-target="#carouselImageControls" data-bs-slide="prev">
								<span class="carousel-control-prev-icon" aria-hidden="true"></span>
								<span class="visually-hidden">Previous</span>
							</button>
							<button class="carousel-control-next" type="button" data-bs-target="#carouselImageControls" data-bs-slide="next">
								<span class="carousel-control-next-icon" aria-hidden="true"></span>
								<span class="visually-hidden">Next</span>
							</button>
						</div>

					</div>
					<div class="card mt-4 mb-4 p-0">
						<div id="carouselVideoControls" class="carousel slide" data-bs-ride="carousel">
							<div class="carousel-inner">
								{% for video in trick.videos %}
									<div class="carousel-item active">
										{% if app.user and app.user is same as trick.user %}
											<a href="{{path('app_delete_video', {id: video.id})}}" class="btn btn-danger position-absolute z-index top-0 end-0" style="z-index: 9999;">
												<i class="bi bi-x-circle-fill"></i>
											</a>
											{% if video.videoPath %}
												<div class="ratio ratio-16x9 rounded">
													<iframe src="{{video.videoPath}}" class="rounded"></iframe>
												</div>
											{% endif %}
											{% if video.videoEmbedCode %}
												{{video.videoEmbedCode | raw}}

											{% endif %}
										{% endif %}
									</div>
								{% endfor %}

							</div>
							<button class="carousel-control-prev" type="button" data-bs-target="#carouselVideoControls" data-bs-slide="prev">
								<span class="carousel-control-prev-icon btn-dark" aria-hidden="true"></span>
								<span class="visually-hidden">Previous</span>
							</button>
							<button class="carousel-control-next" type="button" data-bs-target="#carouselVideoControls" data-bs-slide="next">
								<span class="carousel-control-next-icon btn-dark" aria-hidden="true"></span>
								<span class="visually-hidden">Next</span>
							</button>
						</div>
					</div>
				</div>
			</div>
			<div class="col-12 col-sm-6">
				<div class="mx-auto row d-flex flex-md-row justify-content-md-between justify-content-center text-secondary">
					<h2 class="text-uppercase mt-5">{{trick.title}}</h2>
					<p class="">
						Category:<strong class="text-capitalize ">{{trick.category.name}}</strong>

					</p>
					<p class="text-capitalize">{{trick.description}}</p>
					<p>
						Created by:<strong class="text-capitalize">
							{{trick.user.username}}</strong>
					</p>
					<p>
						Created at:<strong>{{trick.createdAt|date("D-M-Y H:i:s ")}}</strong>
					</p>
				</div>
				{% if app.user and app.user==trick.user  %}
					<a class="btn btn-primary opacity-75" href="{{ path('app_upload_file', { slug: trick.title|slug('_'), id: trick.id }) }}" role="button">Upload file</a>
					<a class="btn btn-primary opacity-75" href="{{ path('app_update', { slug: trick.title|slug('_'), id: trick.id }) }}" role="button">Update</a>
					<a class="btn btn-danger opacity-75" href="{{ path('app_delete', { slug: trick.title|slug('_'), id: trick.id }) }}" role="button">Delete</a>
				{% endif %}

			</div>
		</div>
		<hr>
		<div class="row">
			<h2>Comments</h2>
			<div class="col text-center">
				{% for comment in comments %}
					<div class="row">
						<div class="col">
							<p class="text-capitalize">{{comment.comment}}</p>
						</div>
					</div>
					<div class="row">
						<div class="col-3">
							<p>
								Commented at:<strong class="text-capitalize">{{comment.createAt|date("D-M-Y H:i:s ")}}
								</strong>

							</p>
						</div>
						<div class="col-3">
							-By:<strong class="text-capitalize">{{comment.user.username}}</strong>

							<a href="{{path('app_profile', {id:comment.user.id, username:comment.user.username})}}" class="link link-secondry ml-5">
								{% if comment.user.image %}
									<img src="{{comment.user.image}}" alt="profile image" style="width:30px" class="rounded-circle">
								{% else %}
									<i class="bi bi-person-circle"></i>

								{% endif %}
							</a>

						</div>
					</div>
					<hr>

				{% endfor %}
				<div class="d-flex justify-content-center ">
					{% do comments.setPageRange(2) %}
					{{ knp_pagination_render(comments, 'pagination.html.twig') }}

				</div>
			</div>
			<div>
				{% if app.user %}
					{{ form_start(commentForm) }}
					{{form_row(commentForm.comment)}}
					<button type="submit" class="btn btn-primary opacity-75">Comment</button>
					{{ form_end(commentForm) }}
				{% endif %}

			</div>
		</div>
	</div>


{% endblock %}
